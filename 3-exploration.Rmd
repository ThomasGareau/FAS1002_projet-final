---
title: "Exploration des données"
description: "Dans cette section, nous explorons les données à l'aide des nombreux outils offerts par le langage R"
date: "`r Sys.Date()`"
# Modifier les détails que vous voulez
author:
  - first_name: "Thomas"
    last_name: "Gareau Paquette"
    url: https://github.com/thomasgareau
    # les champs d'affiliation sont optionnels, vous pouvez les
    # comment out en ajoutant un # devant.
    affiliation: FAS1002
    affiliation_url: https://admission.umontreal.ca/programmes/microprogramme-de-1er-cycle-en-analyse-des-megadonnees-en-sciences-humaines-et-sociales/structure-du-programme/
    # changer pour votre propre orcid id
    # https://orcid.org/ pour vous inscrire.
    orcid_id: 0000-0003-4421-4855
# Changer pour votre propre URL si jamais quelqu'un vous cite!
citation_url: https://fas1002.github.io/FAS1002_projet-final
# Inclure les références que vous utilisez dans vos rapports
# dans un fichier biblio.bib. Je conseille Zotero pour construire
# ce fichier ou d'utiliser le package citr dans RStudio.
# Installation: devtools::install_github("crsh/citr")
bibliography: references.bib
output: distill::distill_article
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r, include=FALSE}
library(knitr)
library(tidyverse)
library(kableExtra)
library(skimr) 
library(moderndive)
library(modelsummary)
library(DT)
```

```{r, include=FALSE}
# importer nos scripts
source("data/telecharger_raw.R", local = knit_global())     
source("data/manipulation.R", local = knit_global())      
source("data/open_data_clean.R", local = knit_global())
source("fonctions.R", local = knit_global())        
```


# Section descriptive


### 1. df_continent

Le dataframe `df_continent` recense les variables de **Gapminder** et de **Our World in Data** en fonction des continents. Cette base de données est composée de 4 observations et de 15 variables. Les données permettent d'entrevoir d'importants écarts entre pays en ce qui a trait aux indicateurs qui y ont été ajoutés : 


```{r, echo=FALSE}
tableau_1 <- datatable(df_continent, 
  fillContainer = TRUE, 
  options = list(pageLength = 20),
    caption = "Tableau 1 : Données sur la vaccination par continent")
tableau_1
```
Il est difficile d'inférer quoi que ce soit des mesures de centralité ou de dispersion, tous les pays d'un continent donné ayant le même « poids ». C'était toutefois le « prix à payer » pour avoir une idée précise des données en matière de vaccination en Océanie, en Amérique du Sud et en Amérique du Nord. Nonobstant, les différences de « paysage » entre les continents sont toutefois flagrantes, notamment au regard des disparités par rapport à l'espérance de vie ou aux taux de vaccination moyens.


Il convient aussi de noter les disparités en termes de vaccination totale par cent habitants (`total_vaccinations_per_hundred`). L'écart entre les Amériques et le reste du monde a de quoi laisser dubitatif. Concernant, les statistiques descriptives, celles-ci se présentent ainsi :

```{r, echo=FALSE}
tableau_2 <- df_continent %>%
  select(lifeeexp_2021, total_vaccinations, growth_21_22, people_fully_vaccinated) %>%
datasummary_skim() %>%
  kable_styling(font_size = 4, full_width = FALSE)
tableau_2
```
<br>


Flagrante en termes de de nombre de personnes vaccinées,


```{r}

graphique_1 <- ggplot(df_continent) +
 aes(x = continent, fill = continent, weight = total_vaccinations_per_hundred) +
 geom_bar() + 
  scale_x_discrete(guide = guide_axis(n.dodge=2)) +
 scale_fill_manual(values = c(Afrique = "#A50026", `Amérique du Nord` = "#F46D43", `Amérique du Sud` = "#FEE090",
Asie = "#E0F3F8", Europe = "#74ADD1", Oceanie = "#313695")) +
 labs(x = "Continent", y = "Nombre d'individus vaccinés", 
 title = "Nombre d'individus vaccinés par cent habitants", subtitle = "En fonction du continent", 
 caption = "Source : Our World in data", fill = "Continent") +
 theme_bw() +
 theme(plot.title = element_text(face = "bold.italic"),
    legend.position = "none")

graphique_1
```
<br>


Ces inégalités sont encore plus flagrantes en ce qui a trait au fameux *"booster"*, cette troisième dose maintenant devenue d'une importance capitale en raison du développement et de la généralisation du variant Omicron :  


```{r}
graphique_2 <- ggplot(df_continent) +
 aes(x = continent, fill = continent, weight = total_boosters) +
 geom_bar() +
 scale_fill_manual(values = c(Afrique = "#A50026", 
`Amérique du Nord` = "#F46D43", `Amérique du Sud` = "#FEE08B", Asie = "#D9EF8B", Europe = "#66BD63", 
Oceanie = "#006837")) +
   scale_x_discrete(guide = guide_axis(n.dodge=2)) +
 labs(x = "Continent", y = "Nombre de « boosters » donnés", title = "Nombre de boosters inoculés", 
 subtitle = "En fonction du continent", caption = "Source : Our World in data", fill = "Continent") +
 theme_bw() +
 theme(plot.title = element_text(face = "bold.italic"), legend.position = "none")

graphique_2
```
<br>



En soi, cette banque de données ne sera pas directement utilisée dans nos analyses. Celle-ci permet malgré tout d'appréhender les différences entre les cadres continentaux en termes de vaccination. De plus, des données plus précises sur les continents se trouvent dans la banque de données suivante. Ce sont ces données qui seront utilisées dans le cadre des prochaines analyses lorsque viendra le temps de mobiliser nos variables à l'échelle des continents. La banque de données `df_continent` nous aura toutefois permis d'introduire l'étude des déterminants nationaux de la vaccination, soit ce que nous tâcherons d'élaborer ici. 


### 2. df_country

La deuxième banque de données est beaucoup plus riche en raison du nombre d'observations qui y est associé. Celle-ci est composée de 185 observations et de 15 varuiables. 

La fonction `glimpse` permet d'avoir un aperçu de ce que nous pourrons observer via `df_country`.

```{r, echo=FALSE}
glimpse(df_country)
```

<br>


En tableau « interactif », il est possible de saisir un peu mieux cette vaste banque de données.

```{r, echo=FALSE}
tableau_3 <- datatable(df_country, 
  fillContainer = TRUE, 
  options = list(pageLength = 20),
    caption = "Données sur la vaccination par continent")

tableau_3
```

<br>


Mais qu'en est-il des statistiques descriptives à proprement parler? Encore une fois, faisons appel à la fonction `skim()`, présente dans le package `modelsummary` de Vincent Arel-Bundock : 

```{r, echo=FALSE}
tableau_4 <- df_country %>%
datasummary_skim(caption = "Statistiques descriptives obtenues avec Skim") %>%
  kable_styling(font_size = 4, full_width = FALSE) %>%
  scroll_box(width = "800px", height = "400px")
tableau_4
```

<br>


Ce tableau présente de  nombreuses statistiques descriptives d'importance, à commencer par le nombre d'observations, des mesures de centralité comme la moyenne, des mesures de dispersion comme l'écart type, etc. Les valeurs maximales et minimales sont aussi incluses.

D'une part, les mesures de dispersion pour des variables comme `people_fully_vaccinated_per_hundred` montrent de grands écarts entre les pays par rapport à la moyenne, qui elle est pourtant assez élevée. Ainsi, lorsque **Our World in Data** explique que « [56.9% of the world population has received at least one dose of a COVID-19 vaccine](https://ourworldindata.org/covid-vaccinations), il conviendrait de s'attarder plus spécifiquement à la distribution de ces variables. 

Nos analyses vont se pencher plus spécifiquement sur les déterminants de la vaccination, mais il convient d'emblée de comprendre, et de voir, qui sont les individus vaccinés : 


```{r}
graphique_3 <- ggplot(df_country) +
 aes(x = Income.per.person, y = people_fully_vaccinated_per_hundred, colour = Continent_Name) +
 geom_point(shape = "circle", size = 1.5) + scale_x_discrete(guide = guide_axis(n.dodge=3)) +
 scale_color_brewer(palette = "Paired", direction = 1) +
 labs(x = "Revenu par habitant", y = "Population complètement vaccinée pour 100 habitants", 
 title = "Distribution des individus complètement vaccinés", subtitle = "En fonction du pays en date du 20 décembre 2021", 
 caption = "Graphique 1. Source : Gapminder et Our World in Data", color = "Continent") +
 theme_minimal()

graphique_3

```

<br>


Le graphique ci-haut montre une distribution inégale en fonction des continents et du revenu par habitant. Le graphique 2 illustre lui aussi, mais à l'Aide d'un histogramme, cette distribution :

```{r}
graphique_2 <- ggplot(df_country) +
 aes(x = people_fully_vaccinated_per_hundred, fill = Continent_Name) +
 geom_histogram(bins = 30L) +
 scale_fill_brewer(palette = "Paired", direction = 1) +
 labs(x = "Inidividus complètement vaccinés par 100 habitants", 
 y = "Nombre de pays", title = "Distribution des individus complètement vaccinés", subtitle = "En fonction du pays en date du 20 décembre 2021", 
 caption = "En date du 20 décembre. Source : Gapminder et Our World in Data", fill = "Continent") +
 theme_minimal()
```

<br>


Les pays africains semblent systématiquement désavantagés à quelques rares exceptions près. Nous avions vu l'ampleur de l'écart type lorsque nous analysions les données descriptives de `df_continent`, mais le tout semble vouloir se confirmer. De fait, nous allons vérifier statistiquement cette hypothèse ultérieurement dans la section portant sur les analyses, mais ces déterminants semblent à première vue corrélés à l'espérance de vie pour l'année 2021. 

```{r}
graphique_3 <- ggplot(df_country) +
 aes(x = people_fully_vaccinated_per_hundred, y = lifeeexp_2021, colour = Continent_Name) +
 geom_point(shape = "circle", size = 1.5) +
 scale_color_brewer(palette = "Paired", direction = 1) +
 labs(x = "Inidividus complètement vaccinés par 100 habitants", y = "Espérance de vie", title = "Distribution des individus complètement vaccinés", 
 subtitle = "Croisé avec l'espérance de vie en date du 20 décembre 2021", caption = "En date du 20 décembre. Source : Gapminder et Our World in Data", 
 color = "Continent") +
 theme_minimal()
```



### 3. df_semaine

Cette troisième banque de données, appelée `df_semaine` s'intéresse à la moyenne des doses innoculées par jour sur une semaine. 







```{r}
glimpse(df_semaine)
```





# MESURE DE DISPERSION (sd et iqr)
```{r}
#sd(df$sad)
```

```{r}
#IQR(df$sad)
```


```{r}
#kable(table(df$sag),
#      caption = "",
#      digits=4) %>%
#  kable_styling()
```

## Peut-être que ça vous inspirera!






